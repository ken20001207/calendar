{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\imyua\\\\dev\\\\calendar\\\\pages\\\\index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport Container from \"@material-ui/core/container\";\nimport DayView from \"../comps/DayView\";\nimport fetch from \"isomorphic-unfetch\";\nimport Grid from \"@material-ui/core/Grid\";\nimport { User, Calendar, Event } from \"../classes\";\nimport DayPicker from \"react-day-picker\";\n\nfunction startOfDay(date) {\n  if (!date instanceof Date) {\n    console.error(\"傳入的時間不是合法的 Date 物件。\");\n    return null;\n  }\n\n  date = new Date(date);\n  var time = new Date();\n  time.setTime(date.getTime());\n  time.setHours(0, 0, 0);\n  return time;\n}\n\nfunction endOfDay(date) {\n  if (!date instanceof Date) {\n    console.error(\"傳入的時間不是合法的 Date 物件。\");\n    return null;\n  }\n\n  date = new Date(date);\n  var time = new Date();\n  time.setTime(date.getTime());\n  time.setHours(23, 59, 59);\n  return time;\n}\n\nfunction fillEvents(events, date) {\n  var filled = new Array();\n  var time = startOfDay(date);\n  events.map(function (event) {\n    var startTime = new Date(event.startTime);\n    var endTime = new Date(event.endTime);\n    filled.push(new Event({\n      startTime: time,\n      endTime: startTime\n    }, true));\n    filled.push(event);\n    time.setTime(endTime.getTime());\n  });\n  filled.push(new Event({\n    startTime: time,\n    endTime: endOfDay(date)\n  }, true));\n  return filled;\n}\n\nfunction eventsToDispay(calendars, date) {\n  var eventsToDispay = [];\n  calendars.map(function (calendar) {\n    calendar = new Calendar(calendar);\n    console.log(calendar);\n\n    if (calendar instanceof Calendar) {\n      var tempCal = new Calendar(calendar);\n      var tempEvents = [];\n      tempCal.events.map(function (event) {\n        if (event.startTime.getFullYear() == date.getFullYear() && event.startTime.getMonth() == date.getMonth() && event.startTime.getDate() == date.getDate()) {\n          tempEvents.push(event);\n        }\n      });\n      tempCal.events = tempEvents;\n    } else {\n      console.error(\"收到不符合規範的 calendar 物件\");\n    }\n\n    eventsToDispay.push(tempCal);\n  });\n  return eventsToDispay;\n}\n\nvar index =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(index, _React$Component);\n\n  function index(props) {\n    var _this;\n\n    _classCallCheck(this, index);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(index).call(this, props));\n    _this.state = {\n      selectedDay: new Date(),\n      eventsToDispay: [],\n      userdata: {},\n      filled: []\n    };\n    _this.handleDayClick = _this.handleDayClick.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(index, [{\n    key: \"handleDayClick\",\n    value: function handleDayClick(day, _ref) {\n      var selected, filled;\n      return _regeneratorRuntime.async(function handleDayClick$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              selected = _ref.selected;\n              filled = fillEvents(eventsToDispay(this.props.userdata.calendars, day)[0].events, day);\n              this.setState({\n                selectedDay: selected ? undefined : day,\n                filled: filled\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      setTimeout(function () {\n        var filled = fillEvents(_this2.props.eventsToDispay[0].events, new Date());\n\n        _this2.setState({\n          filled: filled,\n          userdata: _this2.props.userdata\n        });\n      }, 200);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var timeline = {\n        overflowY: \"scroll\",\n        maxHeight: \"90vh\",\n        padding: 24\n      };\n\n      if (this.state.userdata.calendars != undefined) {\n        console.log(eventsToDispay(this.state.userdata.calendars, new Date()));\n        var filled = fillEvents(eventsToDispay(this.state.userdata.calendars, new Date()), new Date());\n        return __jsx(Container, {\n          maxWidth: \"md\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }, __jsx(Grid, {\n          container: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, __jsx(Grid, {\n          item: true,\n          xs: 5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, __jsx(\"div\", {\n          style: {\n            marginTop: 80\n          },\n          className: \"jsx-3288069184\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, __jsx(DayPicker, {\n          selectedDays: this.state.selectedDay,\n          onDayClick: this.handleDayClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }))), __jsx(Grid, {\n          item: true,\n          xs: 7,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, __jsx(\"div\", {\n          style: timeline,\n          className: \"jsx-3288069184\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, __jsx(DayView, {\n          events: filled,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        })))), __jsx(_JSXStyle, {\n          id: \"3288069184\",\n          __self: this\n        }, \"body{background:#333333;}::-webkit-scrollbar{width:5px;}::-webkit-scrollbar-track{-webkit-border-radius:10px;border-radius:10px;margin:80px 0 5px 0;}::-webkit-scrollbar-thumb{-webkit-border-radius:4px;border-radius:4px;background:rgb(80,80,80);}.DayPicker{display:inline-block;font-size:1rem;}.DayPicker-wrapper{position:relative;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding-bottom:1em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.DayPicker-Months{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.DayPicker-Month{display:table;margin:0 1em;margin-top:1em;border-spacing:0;border-collapse:collapse;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.DayPicker-NavButton{position:absolute;top:1em;right:1.5em;left:auto;display:inline-block;margin-top:2px;width:1.25em;height:1.25em;background-position:center;background-size:50%;background-repeat:no-repeat;color:#8b9898;cursor:pointer;}.DayPicker-NavButton:hover{opacity:0.8;}.DayPicker-NavButton--prev{margin-right:1.5em;background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAwCAYAAAB5R9gVAAAABGdBTUEAALGPC/xhBQAAAVVJREFUWAnN2G0KgjAYwPHpGfRkaZeqvgQaK+hY3SUHrk1YzNLay/OiEFp92I+/Mp2F2Mh2lLISWnflFjzH263RQjzMZ19wgs73ez0o1WmtW+dgA01VxrE3p6l2GLsnBy1VYQOtVSEH/atCCgqpQgKKqYIOiq2CBkqtggLKqQIKgqgCBjpJ2Y5CdJ+zrT9A7HHSTA1dxUdHgzCqJIEwq0SDsKsEg6iqBIEoq/wEcVRZBXFV+QJxV5mBtlDFB5VjYTaGZ2sf4R9PM7U9ZU+lLuaetPP/5Die3ToO1+u+MKtHs06qODB2zBnI/jBd4MPQm1VkY79Tb18gB+C62FdBFsZR6yeIo1YQiLJWMIiqVjQIu1YSCLNWFgijVjYIuhYYCKoWKAiiFgoopxYaKLUWOii2FgkophYp6F3r42W5A9s9OcgNvva8xQaysKXlFytoqdYmQH6tF3toSUo0INq9AAAAAElFTkSuQmCC\\\");}.DayPicker-NavButton--next{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAwCAYAAAB5R9gVAAAABGdBTUEAALGPC/xhBQAAAXRJREFUWAnN119ugjAcwPHWzJ1gnmxzB/BBE0n24m4xfNkTaOL7wOtsl3AXMMb+Vjaa1BG00N8fSEibPpAP3xAKKs2yjzTPH9RAjhEo9WzPr/Vm8zgE0+gXATAxxuxtqeJ9t5tIwv5AtQAApsfT6TPdbp+kUBcgVwvO51KqVhMkXKsVJFXrOkigVhCIs1Y4iKlWZxB1rX4gwlpRIIpa8SDkWmggrFq4IIRaJKCYWnSgnrXIQV1r8YD+1Vrn+bReagysIFfLABRt31v8oBu1xEBttfRbltmfjgEcWh9snUS2kNdBK6WN1vrOWxObWsz+fjxevsxmB1GQDfINWiev83nhaoiB/CoOU438oPrhXS0WpQ9xc1ZQWxWHqUYe0I0qrKCQKjygDlXIQV2r0IF6ViEBxVTBBSFUQQNhVYkHIVeJAtkNsbQ7c1LtzP6FsObhb2rCKv7NBIGoq4SDmKoEgTirXAcJVGkFSVVpgoSrXICGUMUH/QBZNSUy5XWUhwAAAABJRU5ErkJggg==\\\");}.DayPicker-NavButton--interactionDisabled{display:none;}.DayPicker-Caption{display:table-caption;margin-bottom:0.5em;padding:0 0.5em;text-align:left;color:white;}.DayPicker-Caption>div{font-weight:500;font-size:1.15em;}.DayPicker-Weekdays{display:table-header-group;margin-top:1em;}.DayPicker-WeekdaysRow{display:table-row;}.DayPicker-Weekday{display:table-cell;padding:0.5em;color:#8b9898;text-align:center;font-size:0.875em;}.DayPicker-Weekday abbr[title]{border-bottom:none;-webkit-text-decoration:none;text-decoration:none;}.DayPicker-Body{display:table-row-group;}.DayPicker-Week{display:table-row;}.DayPicker-Day{display:table-cell;padding:0.5em;border-radius:50%;vertical-align:middle;text-align:center;cursor:pointer;color:gray;}.DayPicker-WeekNumber{display:table-cell;padding:0.5em;min-width:1em;border-right:1px solid #eaecec;color:#8b9898;vertical-align:middle;text-align:right;font-size:0.75em;cursor:pointer;}.DayPicker--interactionDisabled .DayPicker-Day{cursor:default;}.DayPicker-Footer{padding-top:0.5em;}.DayPicker-TodayButton{border:none;background-color:transparent;background-image:none;box-shadow:none;color:#4a90e2;font-size:0.875em;cursor:pointer;}.DayPicker-Day--today{color:white;font-weight:700;}.DayPicker-Day--outside{color:#8b9898;cursor:default;}.DayPicker-Day--disabled{color:#dce0e0;cursor:default;}.DayPicker-Day--sunday{background-color:#f7f8f8;}.DayPicker-Day--sunday:not(.DayPicker-Day--today){color:#dce0e0;}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside){position:relative;background-color:#4a90e2;color:#f0f8ff;}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside):hover{background-color:#51a0fa;}.DayPicker:not(.DayPicker--interactionDisabled) .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside):hover{background-color:#f0f8ff;}.DayPickerInput{display:inline-block;}.DayPickerInput-OverlayWrapper{position:relative;}.DayPickerInput-Overlay{position:absolute;left:0;z-index:1;background:white;box-shadow:0 2px 5px rgba(0,0,0,0.15);}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcaW15dWFcXGRldlxcY2FsZW5kYXJcXHBhZ2VzXFxpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF1SXVDLEFBR2dELEFBR1QsQUFHaUIsQUFLRCxBQU9MLEFBS0gsQUFlTCxBQU1DLEFBZ0JJLEFBaUJOLEFBSU8sQUFLZ25CLEFBSXRuQixBQUlTLEFBUU4sQUFLVyxBQUtULEFBSUMsQUFRQSxBQUtLLEFBSU4sQUFJQyxBQVVBLEFBWUosQUFJRyxBQUlOLEFBVUEsQUFLRSxBQUtBLEFBUVcsQUFJWCxBQUlJLEFBT08sQUFLQSxBQU1KLEFBSUgsQUFJQSxVQWpPdEIsRUEwRUEsQUEwRmlDLEFBVWIsQ0F2RnBCLENBOUNpQixBQTBJRSxBQUtBLEFBWW5CLENBeENBLENBekRxQixFQTlFRSxBQW9DWCxBQW9EWixBQXFCQSxBQThCQSxBQXlDNkIsQUFxQjdCLEFBSVcsQ0FyT1gsQUFpRjJsQixBQW1DemtCLEFBUU8sQUFhUCxBQVVBLEVBaklDLEFBMk1uQixDQS9Id0IsRUFtQ3hCLENBa0VBLEFBZUEsQUFLQSxBQWVjLENBM05RLEFBa0ROLENBdkRPLEFBdUNKLEFBOERBLENBdUVuQixDQUtBLEFBTUEsSUF0RkEsQUFja0IsQUFxQkksQUFVSixFQW9GRyxDQXJOckIsRUEyQ2MsR0EwR1ksQ0ExSEwsQUFpREQsQUFhcEIsQ0FpR2tCLENBak1hLEVBTFAsQ0ErR0YsQUErQmEsQ0FyRlYsR0EyRUMsQ0E4Rm1CLEtBM0I3QyxDQTlHb0IsQ0FqRFMsSUEwSFQsRUFsREUsQ0EvR3RCLEdBS0EsQUFvRG1CLEFBNERuQixJQWVzQixDQXRHSCxBQTJESCxJQXFERSxDQW9CQSxJQWxEbEIsQ0F2RTZCLEFBaUJaLEVBZ0NqQixDQXpFdUIsR0FpTnZCLENBN0ZtQixDQVVPLENBb0JKLElBeEdKLFNBeENXLEFBbUhkLEdBM0ZXLEVBaUJLLEFBd0daLEdBcEJFLEdBVHJCLFNBOEJBLEtBaEowQixBQVVDLEFBY0YsQUFvR0osT0FwRkcsVUFxRkwsSUFuR0UsQ0F4QkksS0F1Q08sS0FxRmhDLFdBMUhxQixZQXNDSCxjQUNDLGVBQ25CLGVBakNBLE9BZ0JBLHNCQXRCQSx1V0FnREEseUJBSUEiLCJmaWxlIjoiQzpcXFVzZXJzXFxpbXl1YVxcZGV2XFxjYWxlbmRhclxccGFnZXNcXGluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgQ29udGFpbmVyIGZyb20gXCJAbWF0ZXJpYWwtdWkvY29yZS9jb250YWluZXJcIjtcclxuaW1wb3J0IERheVZpZXcgZnJvbSBcIi4uL2NvbXBzL0RheVZpZXdcIjtcclxuaW1wb3J0IGZldGNoIGZyb20gXCJpc29tb3JwaGljLXVuZmV0Y2hcIjtcclxuaW1wb3J0IEdyaWQgZnJvbSBcIkBtYXRlcmlhbC11aS9jb3JlL0dyaWRcIjtcclxuaW1wb3J0IHsgVXNlciwgQ2FsZW5kYXIsIEV2ZW50IH0gZnJvbSBcIi4uL2NsYXNzZXNcIjtcclxuaW1wb3J0IERheVBpY2tlciBmcm9tIFwicmVhY3QtZGF5LXBpY2tlclwiO1xyXG5cclxuZnVuY3Rpb24gc3RhcnRPZkRheShkYXRlKSB7XHJcbiAgICBpZiAoIWRhdGUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIuWCs+WFpeeahOaZgumWk+S4jeaYr+WQiOazleeahCBEYXRlIOeJqeS7tuOAglwiKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGRhdGUgPSBuZXcgRGF0ZShkYXRlKTtcclxuICAgIHZhciB0aW1lID0gbmV3IERhdGUoKTtcclxuICAgIHRpbWUuc2V0VGltZShkYXRlLmdldFRpbWUoKSk7XHJcbiAgICB0aW1lLnNldEhvdXJzKDAsIDAsIDApO1xyXG4gICAgcmV0dXJuIHRpbWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuZE9mRGF5KGRhdGUpIHtcclxuICAgIGlmICghZGF0ZSBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwi5YKz5YWl55qE5pmC6ZaT5LiN5piv5ZCI5rOV55qEIERhdGUg54mp5Lu244CCXCIpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xyXG4gICAgdmFyIHRpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdGltZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpKTtcclxuICAgIHRpbWUuc2V0SG91cnMoMjMsIDU5LCA1OSk7XHJcbiAgICByZXR1cm4gdGltZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZmlsbEV2ZW50cyhldmVudHMsIGRhdGUpIHtcclxuICAgIHZhciBmaWxsZWQgPSBuZXcgQXJyYXkoKTtcclxuICAgIHZhciB0aW1lID0gc3RhcnRPZkRheShkYXRlKTtcclxuICAgIGV2ZW50cy5tYXAoZXZlbnQgPT4ge1xyXG4gICAgICAgIHZhciBzdGFydFRpbWUgPSBuZXcgRGF0ZShldmVudC5zdGFydFRpbWUpO1xyXG4gICAgICAgIHZhciBlbmRUaW1lID0gbmV3IERhdGUoZXZlbnQuZW5kVGltZSk7XHJcbiAgICAgICAgZmlsbGVkLnB1c2gobmV3IEV2ZW50KHsgc3RhcnRUaW1lOiB0aW1lLCBlbmRUaW1lOiBzdGFydFRpbWUgfSwgdHJ1ZSkpO1xyXG4gICAgICAgIGZpbGxlZC5wdXNoKGV2ZW50KTtcclxuICAgICAgICB0aW1lLnNldFRpbWUoZW5kVGltZS5nZXRUaW1lKCkpO1xyXG4gICAgfSk7XHJcbiAgICBmaWxsZWQucHVzaChuZXcgRXZlbnQoeyBzdGFydFRpbWU6IHRpbWUsIGVuZFRpbWU6IGVuZE9mRGF5KGRhdGUpIH0sIHRydWUpKTtcclxuICAgIHJldHVybiBmaWxsZWQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV2ZW50c1RvRGlzcGF5KGNhbGVuZGFycywgZGF0ZSkge1xyXG4gICAgdmFyIGV2ZW50c1RvRGlzcGF5ID0gW107XHJcbiAgICBjYWxlbmRhcnMubWFwKGNhbGVuZGFyID0+IHtcclxuICAgICAgICBjYWxlbmRhciA9IG5ldyBDYWxlbmRhcihjYWxlbmRhcik7XHJcbiAgICAgICAgY29uc29sZS5sb2coY2FsZW5kYXIpO1xyXG4gICAgICAgIGlmIChjYWxlbmRhciBpbnN0YW5jZW9mIENhbGVuZGFyKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wQ2FsID0gbmV3IENhbGVuZGFyKGNhbGVuZGFyKTtcclxuICAgICAgICAgICAgdmFyIHRlbXBFdmVudHMgPSBbXTtcclxuICAgICAgICAgICAgdGVtcENhbC5ldmVudHMubWFwKGV2ZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5zdGFydFRpbWUuZ2V0RnVsbFllYXIoKSA9PSBkYXRlLmdldEZ1bGxZZWFyKCkgJiZcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5zdGFydFRpbWUuZ2V0TW9udGgoKSA9PSBkYXRlLmdldE1vbnRoKCkgJiZcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5zdGFydFRpbWUuZ2V0RGF0ZSgpID09IGRhdGUuZ2V0RGF0ZSgpXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wRXZlbnRzLnB1c2goZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGVtcENhbC5ldmVudHMgPSB0ZW1wRXZlbnRzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCLmlLbliLDkuI3nrKblkIjopo/nr4TnmoQgY2FsZW5kYXIg54mp5Lu2XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZXZlbnRzVG9EaXNwYXkucHVzaCh0ZW1wQ2FsKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGV2ZW50c1RvRGlzcGF5O1xyXG59XHJcblxyXG5jbGFzcyBpbmRleCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgICAgICBzZWxlY3RlZERheTogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgZXZlbnRzVG9EaXNwYXk6IFtdLFxyXG4gICAgICAgICAgICB1c2VyZGF0YToge30sXHJcbiAgICAgICAgICAgIGZpbGxlZDogW11cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuaGFuZGxlRGF5Q2xpY2sgPSB0aGlzLmhhbmRsZURheUNsaWNrLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgaGFuZGxlRGF5Q2xpY2soZGF5LCB7IHNlbGVjdGVkIH0pIHtcclxuICAgICAgICB2YXIgZmlsbGVkID0gZmlsbEV2ZW50cyhldmVudHNUb0Rpc3BheSh0aGlzLnByb3BzLnVzZXJkYXRhLmNhbGVuZGFycywgZGF5KVswXS5ldmVudHMsIGRheSk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkRGF5OiBzZWxlY3RlZCA/IHVuZGVmaW5lZCA6IGRheSxcclxuICAgICAgICAgICAgZmlsbGVkOiBmaWxsZWRcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgYXN5bmMgZ2V0SW5pdGlhbFByb3BzKCkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKFwiaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9nZXR1c2VyZGF0YVwiKTtcclxuICAgICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgICAgICB2YXIgdXNlcmRhdGEgPSBuZXcgVXNlcihqc29uKTtcclxuICAgICAgICB2YXIgZXRkID0gZXZlbnRzVG9EaXNwYXkodXNlcmRhdGEuY2FsZW5kYXJzLCBuZXcgRGF0ZSgpKTtcclxuICAgICAgICB2YXIgZmlsbGVkID0gZmlsbEV2ZW50cyhldmVudHNUb0Rpc3BheSh1c2VyZGF0YS5jYWxlbmRhcnMsIG5ldyBEYXRlKCkpWzBdLmV2ZW50cywgbmV3IERhdGUoKSk7XHJcbiAgICAgICAgcmV0dXJuIHsgdXNlcmRhdGE6IHVzZXJkYXRhLCBmaWxsZWQ6IGZpbGxlZCwgZXZlbnRzVG9EaXNwYXk6IGV0ZCB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgZmlsbGVkID0gZmlsbEV2ZW50cyh0aGlzLnByb3BzLmV2ZW50c1RvRGlzcGF5WzBdLmV2ZW50cywgbmV3IERhdGUoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBmaWxsZWQ6IGZpbGxlZCwgdXNlcmRhdGE6IHRoaXMucHJvcHMudXNlcmRhdGEgfSk7XHJcbiAgICAgICAgfSwgMjAwKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3QgdGltZWxpbmUgPSB7XHJcbiAgICAgICAgICAgIG92ZXJmbG93WTogXCJzY3JvbGxcIixcclxuICAgICAgICAgICAgbWF4SGVpZ2h0OiBcIjkwdmhcIixcclxuICAgICAgICAgICAgcGFkZGluZzogMjRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5zdGF0ZS51c2VyZGF0YS5jYWxlbmRhcnMgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGV2ZW50c1RvRGlzcGF5KHRoaXMuc3RhdGUudXNlcmRhdGEuY2FsZW5kYXJzLCBuZXcgRGF0ZSgpKSk7XHJcbiAgICAgICAgICAgIHZhciBmaWxsZWQgPSBmaWxsRXZlbnRzKGV2ZW50c1RvRGlzcGF5KHRoaXMuc3RhdGUudXNlcmRhdGEuY2FsZW5kYXJzLCBuZXcgRGF0ZSgpKSwgbmV3IERhdGUoKSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgPENvbnRhaW5lciBtYXhXaWR0aD1cIm1kXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPEdyaWQgY29udGFpbmVyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8R3JpZCBpdGVtIHhzPXs1fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3sgbWFyZ2luVG9wOiA4MCB9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RGF5UGlja2VyIHNlbGVjdGVkRGF5cz17dGhpcy5zdGF0ZS5zZWxlY3RlZERheX0gb25EYXlDbGljaz17dGhpcy5oYW5kbGVEYXlDbGlja30gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0dyaWQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxHcmlkIGl0ZW0geHM9ezd9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17dGltZWxpbmV9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEYXlWaWV3IGV2ZW50cz17ZmlsbGVkfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvR3JpZD5cclxuICAgICAgICAgICAgICAgICAgICA8L0dyaWQ+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIDxzdHlsZSBnbG9iYWwganN4PntgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogIzMzMzMzMztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiA1cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiA4MHB4IDAgNXB4IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYig4MCwgODAsIDgwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBEYXlQaWNrZXIgc3R5bGVzICovXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMXJlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci13cmFwcGVyIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZy1ib3R0b206IDFlbTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLW1zLXVzZXItc2VsZWN0OiBub25lO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLU1vbnRocyB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItTW9udGgge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdGFibGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW46IDAgMWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXNwYWNpbmc6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItTmF2QnV0dG9uIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogMWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IDEuNWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogYXV0bztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOiAycHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMS4yNWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxLjI1ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IDUwJTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogIzhiOTg5ODtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1OYXZCdXR0b246aG92ZXIge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC44O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLU5hdkJ1dHRvbi0tcHJldiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDEuNWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDUUFBQUF3Q0FZQUFBQjVSOWdWQUFBQUJHZEJUVUVBQUxHUEMveGhCUUFBQVZWSlJFRlVXQW5OMkcwS2dqQVl3UEhwR2ZSa2FaZXF2Z1FhSytoWTNTVUhyazFZek5MYXkvT2lFRnA5MkkrL01wMkYyTWgybExJU1duZmxGanpIMjYzUlFqek1aMTl3Z3M3M2V6MG8xV210VytkZ0EwMVZ4ckUzcDZsMkdMc25CeTFWWVFPdFZTRUgvYXRDQ2dxcFFnS0txWUlPaXEyQ0JrcXRnZ0xLcVFJS2dxZ0NCanBKMlk1Q2RKK3pyVDlBN0hIU1RBMWR4VWRIZ3pDcUpJRXdxMFNEc0tzRWc2aXFCSUVvcS93RWNWUlpCWEZWK1FKeFY1bUJ0bERGQjVWallUYUdaMnNmNFI5UE03VTlaVStsTHVhZXRQUC81RGllM1RvTzErdStNS3RIczA2cU9EQjJ6Qm5JL2pCZDRNUFFtMVZrWTc5VGIxOGdCK0M2MkZkQkZzWlI2eWVJbzFZUWlMSldNSWlxVmpRSXUxWVNDTE5XRmdpalZqWUl1aFlZQ0tvV0tBaWlGZ29vcHhZYUtMVVdPaWkyRmdrb3BoWXA2RjNyNDJXNUE5czlPY2dOdnZhOHhRYXlzS1hsRnl0b3FkWW1RSDZ0RjN0b1NVbzBJTnE5QUFBQUFFbEZUa1N1UW1DQ1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1OYXZCdXR0b24tLW5leHQge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDUUFBQUF3Q0FZQUFBQjVSOWdWQUFBQUJHZEJUVUVBQUxHUEMveGhCUUFBQVhSSlJFRlVXQW5OMTE5dWdqQWN3UEhXekoxZ25teHpCL0JCRTBuMjRtNHhmTmtUYU9MN3dPdHNsM0FYTU1iK1ZqYWExQkcwME44ZlNFaWJQcEFQM3hBS0tzMnlqelRQSDlSQWpoRW85V3pQci9WbTh6Z0UwK2dYQVRBeHh1eHRxZUo5dDV0SXd2NUF0UUFBcHNmVDZUUGRicCtrVUJjZ1Z3dk81MUtxVmhNa1hLc1ZKRlhyT2tpZ1ZoQ0lzMVk0aUtsV1p4QjFyWDRnd2xwUklJcGE4U0RrV21nZ3JGcTRJSVJhSktDWVduU2duclhJUVYxcjhZRCsxVnJuK2JSZWFneXNJRmZMQUJSdDMxdjhvQnUxeEVCdHRmUmJsdG1mamdFY1doOXNuVVMya05kQks2V04xdnJPV3hPYldzeitmanhldnN4bUIxR1FEZklOV2lldjgzbmhhb2lCL0NvT1U0MzhvUHJoWFMwV3BROXhjMVpRV3hXSHFVWWUwSTBxcktDUUtqeWdEbFhJUVYycjBJRjZWaUVCeFZUQkJTRlVRUU5oVllrSElWZUpBdGtOc2JRN2MxTHR6UDZGc09iaGIyckNLdjdOQklHb3E0U0RtS29FZ1RpclhBY0pWR2tGU1ZWcGdvU3JYSUNHVU1VSC9RQlpOU1V5NVhXVWh3QUFBQUJKUlU1RXJrSmdnZz09XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLU5hdkJ1dHRvbi0taW50ZXJhY3Rpb25EaXNhYmxlZCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBub25lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLUNhcHRpb24ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdGFibGUtY2FwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDAuNWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMCAwLjVlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItQ2FwdGlvbiA+IGRpdiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAxLjE1ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItV2Vla2RheXMge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdGFibGUtaGVhZGVyLWdyb3VwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLVdlZWtkYXlzUm93IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IHRhYmxlLXJvdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1XZWVrZGF5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IHRhYmxlLWNlbGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLjVlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjOGI5ODk4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjg3NWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLVdlZWtkYXkgYWJiclt0aXRsZV0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogbm9uZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1Cb2R5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IHRhYmxlLXJvdy1ncm91cDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1XZWVrIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IHRhYmxlLXJvdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1EYXkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdGFibGUtY2VsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAuNWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBncmF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLVdlZWtOdW1iZXIge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdGFibGUtY2VsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAuNWVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluLXdpZHRoOiAxZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjZWFlY2VjO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICM4Yjk4OTg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuNzVlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci0taW50ZXJhY3Rpb25EaXNhYmxlZCAuRGF5UGlja2VyLURheSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IGRlZmF1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItRm9vdGVyIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmctdG9wOiAwLjVlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1Ub2RheUJ1dHRvbiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IG5vbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3gtc2hhZG93OiBub25lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICM0YTkwZTI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuODc1ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItRGF5LS10b2RheSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNzAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuRGF5UGlja2VyLURheS0tb3V0c2lkZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogIzhiOTg5ODtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogZGVmYXVsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1EYXktLWRpc2FibGVkIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjZGNlMGUwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiBkZWZhdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogYmFja2dyb3VuZC1jb2xvcjogI2VmZjFmMTsgKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLyogRXhhbXBsZSBtb2RpZmllcnMgKi9cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItRGF5LS1zdW5kYXkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y3ZjhmODtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1EYXktLXN1bmRheTpub3QoLkRheVBpY2tlci1EYXktLXRvZGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogI2RjZTBlMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1EYXktLXNlbGVjdGVkOm5vdCguRGF5UGlja2VyLURheS0tZGlzYWJsZWQpOm5vdCguRGF5UGlja2VyLURheS0tb3V0c2lkZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0YTkwZTI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogI2YwZjhmZjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlci1EYXktLXNlbGVjdGVkOm5vdCguRGF5UGlja2VyLURheS0tZGlzYWJsZWQpOm5vdCguRGF5UGlja2VyLURheS0tb3V0c2lkZSk6aG92ZXIge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzUxYTBmYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLkRheVBpY2tlcjpub3QoLkRheVBpY2tlci0taW50ZXJhY3Rpb25EaXNhYmxlZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXItRGF5Om5vdCguRGF5UGlja2VyLURheS0tZGlzYWJsZWQpOm5vdCguRGF5UGlja2VyLURheS0tc2VsZWN0ZWQpOm5vdCguRGF5UGlja2VyLURheS0tb3V0c2lkZSk6aG92ZXIge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2YwZjhmZjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLyogRGF5UGlja2VySW5wdXQgKi9cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXJJbnB1dCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXJJbnB1dC1PdmVybGF5V3JhcHBlciB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5EYXlQaWNrZXJJbnB1dC1PdmVybGF5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6LWluZGV4OiAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCAycHggNXB4IHJnYmEoMCwgMCwgMCwgMC4xNSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBgfTwvc3R5bGU+XHJcbiAgICAgICAgICAgICAgICA8L0NvbnRhaW5lcj5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gPHA+bG9hZGluZzwvcD47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBpbmRleDtcclxuIl19 */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\imyua\\\\\\\\dev\\\\\\\\calendar\\\\\\\\pages\\\\\\\\index.js */\"));\n      } else {\n        return __jsx(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 378\n          },\n          __self: this\n        }, \"loading\");\n      }\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function getInitialProps() {\n      var res, json, userdata, etd, filled;\n      return _regeneratorRuntime.async(function getInitialProps$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(fetch(\"http://localhost:3000/api/getuserdata\"));\n\n            case 2:\n              res = _context2.sent;\n              _context2.next = 5;\n              return _regeneratorRuntime.awrap(res.json());\n\n            case 5:\n              json = _context2.sent;\n              userdata = new User(json);\n              etd = eventsToDispay(userdata.calendars, new Date());\n              filled = fillEvents(eventsToDispay(userdata.calendars, new Date())[0].events, new Date());\n              return _context2.abrupt(\"return\", {\n                userdata: userdata,\n                filled: filled,\n                eventsToDispay: etd\n              });\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      });\n    }\n  }]);\n\n  return index;\n}(React.Component);\n\nexport default index;","map":{"version":3,"sources":["C:/Users/imyua/dev/calendar/pages/index.js"],"names":["React","Container","DayView","fetch","Grid","User","Calendar","Event","DayPicker","startOfDay","date","Date","console","error","time","setTime","getTime","setHours","endOfDay","fillEvents","events","filled","Array","map","event","startTime","endTime","push","eventsToDispay","calendars","calendar","log","tempCal","tempEvents","getFullYear","getMonth","getDate","index","props","state","selectedDay","userdata","handleDayClick","bind","day","selected","setState","undefined","setTimeout","timeline","overflowY","maxHeight","padding","marginTop","res","json","etd","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Container from \"@material-ui/core/container\";\r\nimport DayView from \"../comps/DayView\";\r\nimport fetch from \"isomorphic-unfetch\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { User, Calendar, Event } from \"../classes\";\r\nimport DayPicker from \"react-day-picker\";\r\n\r\nfunction startOfDay(date) {\r\n    if (!date instanceof Date) {\r\n        console.error(\"傳入的時間不是合法的 Date 物件。\");\r\n        return null;\r\n    }\r\n    date = new Date(date);\r\n    var time = new Date();\r\n    time.setTime(date.getTime());\r\n    time.setHours(0, 0, 0);\r\n    return time;\r\n}\r\n\r\nfunction endOfDay(date) {\r\n    if (!date instanceof Date) {\r\n        console.error(\"傳入的時間不是合法的 Date 物件。\");\r\n        return null;\r\n    }\r\n    date = new Date(date);\r\n    var time = new Date();\r\n    time.setTime(date.getTime());\r\n    time.setHours(23, 59, 59);\r\n    return time;\r\n}\r\n\r\nfunction fillEvents(events, date) {\r\n    var filled = new Array();\r\n    var time = startOfDay(date);\r\n    events.map(event => {\r\n        var startTime = new Date(event.startTime);\r\n        var endTime = new Date(event.endTime);\r\n        filled.push(new Event({ startTime: time, endTime: startTime }, true));\r\n        filled.push(event);\r\n        time.setTime(endTime.getTime());\r\n    });\r\n    filled.push(new Event({ startTime: time, endTime: endOfDay(date) }, true));\r\n    return filled;\r\n}\r\n\r\nfunction eventsToDispay(calendars, date) {\r\n    var eventsToDispay = [];\r\n    calendars.map(calendar => {\r\n        calendar = new Calendar(calendar);\r\n        console.log(calendar);\r\n        if (calendar instanceof Calendar) {\r\n            var tempCal = new Calendar(calendar);\r\n            var tempEvents = [];\r\n            tempCal.events.map(event => {\r\n                if (\r\n                    event.startTime.getFullYear() == date.getFullYear() &&\r\n                    event.startTime.getMonth() == date.getMonth() &&\r\n                    event.startTime.getDate() == date.getDate()\r\n                ) {\r\n                    tempEvents.push(event);\r\n                }\r\n            });\r\n            tempCal.events = tempEvents;\r\n        } else {\r\n            console.error(\"收到不符合規範的 calendar 物件\");\r\n        }\r\n\r\n        eventsToDispay.push(tempCal);\r\n    });\r\n    return eventsToDispay;\r\n}\r\n\r\nclass index extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            selectedDay: new Date(),\r\n            eventsToDispay: [],\r\n            userdata: {},\r\n            filled: []\r\n        };\r\n        this.handleDayClick = this.handleDayClick.bind(this);\r\n    }\r\n\r\n    async handleDayClick(day, { selected }) {\r\n        var filled = fillEvents(eventsToDispay(this.props.userdata.calendars, day)[0].events, day);\r\n        this.setState({\r\n            selectedDay: selected ? undefined : day,\r\n            filled: filled\r\n        });\r\n    }\r\n\r\n    static async getInitialProps() {\r\n        const res = await fetch(\"http://localhost:3000/api/getuserdata\");\r\n        const json = await res.json();\r\n        var userdata = new User(json);\r\n        var etd = eventsToDispay(userdata.calendars, new Date());\r\n        var filled = fillEvents(eventsToDispay(userdata.calendars, new Date())[0].events, new Date());\r\n        return { userdata: userdata, filled: filled, eventsToDispay: etd };\r\n    }\r\n\r\n    componentDidMount() {\r\n        setTimeout(() => {\r\n            var filled = fillEvents(this.props.eventsToDispay[0].events, new Date());\r\n            this.setState({ filled: filled, userdata: this.props.userdata });\r\n        }, 200);\r\n    }\r\n\r\n    render() {\r\n        const timeline = {\r\n            overflowY: \"scroll\",\r\n            maxHeight: \"90vh\",\r\n            padding: 24\r\n        };\r\n\r\n        if (this.state.userdata.calendars != undefined) {\r\n            console.log(eventsToDispay(this.state.userdata.calendars, new Date()));\r\n            var filled = fillEvents(eventsToDispay(this.state.userdata.calendars, new Date()), new Date());\r\n\r\n            return (\r\n                <Container maxWidth=\"md\">\r\n                    <Grid container>\r\n                        <Grid item xs={5}>\r\n                            <div style={{ marginTop: 80 }}>\r\n                                <DayPicker selectedDays={this.state.selectedDay} onDayClick={this.handleDayClick} />\r\n                            </div>\r\n                        </Grid>\r\n                        <Grid item xs={7}>\r\n                            <div style={timeline}>\r\n                                <DayView events={filled} />\r\n                            </div>\r\n                        </Grid>\r\n                    </Grid>\r\n\r\n                    <style global jsx>{`\r\n                        body {\r\n                            background: #333333;\r\n                        }\r\n                        ::-webkit-scrollbar {\r\n                            width: 5px;\r\n                        }\r\n                        ::-webkit-scrollbar-track {\r\n                            -webkit-border-radius: 10px;\r\n                            border-radius: 10px;\r\n                            margin: 80px 0 5px 0;\r\n                        }\r\n                        ::-webkit-scrollbar-thumb {\r\n                            -webkit-border-radius: 4px;\r\n                            border-radius: 4px;\r\n                            background: rgb(80, 80, 80);\r\n                        }\r\n                        /* DayPicker styles */\r\n\r\n                        .DayPicker {\r\n                            display: inline-block;\r\n                            font-size: 1rem;\r\n                        }\r\n\r\n                        .DayPicker-wrapper {\r\n                            position: relative;\r\n\r\n                            flex-direction: row;\r\n                            padding-bottom: 1em;\r\n\r\n                            -webkit-user-select: none;\r\n\r\n                            -moz-user-select: none;\r\n\r\n                            -ms-user-select: none;\r\n\r\n                            user-select: none;\r\n                        }\r\n\r\n                        .DayPicker-Months {\r\n                            display: flex;\r\n                            flex-wrap: wrap;\r\n                            justify-content: center;\r\n                        }\r\n\r\n                        .DayPicker-Month {\r\n                            display: table;\r\n                            margin: 0 1em;\r\n                            margin-top: 1em;\r\n                            border-spacing: 0;\r\n                            border-collapse: collapse;\r\n\r\n                            -webkit-user-select: none;\r\n\r\n                            -moz-user-select: none;\r\n\r\n                            -ms-user-select: none;\r\n\r\n                            user-select: none;\r\n                        }\r\n\r\n                        .DayPicker-NavButton {\r\n                            position: absolute;\r\n                            top: 1em;\r\n                            right: 1.5em;\r\n                            left: auto;\r\n\r\n                            display: inline-block;\r\n                            margin-top: 2px;\r\n                            width: 1.25em;\r\n                            height: 1.25em;\r\n                            background-position: center;\r\n                            background-size: 50%;\r\n                            background-repeat: no-repeat;\r\n                            color: #8b9898;\r\n                            cursor: pointer;\r\n                        }\r\n\r\n                        .DayPicker-NavButton:hover {\r\n                            opacity: 0.8;\r\n                        }\r\n\r\n                        .DayPicker-NavButton--prev {\r\n                            margin-right: 1.5em;\r\n                            background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAwCAYAAAB5R9gVAAAABGdBTUEAALGPC/xhBQAAAVVJREFUWAnN2G0KgjAYwPHpGfRkaZeqvgQaK+hY3SUHrk1YzNLay/OiEFp92I+/Mp2F2Mh2lLISWnflFjzH263RQjzMZ19wgs73ez0o1WmtW+dgA01VxrE3p6l2GLsnBy1VYQOtVSEH/atCCgqpQgKKqYIOiq2CBkqtggLKqQIKgqgCBjpJ2Y5CdJ+zrT9A7HHSTA1dxUdHgzCqJIEwq0SDsKsEg6iqBIEoq/wEcVRZBXFV+QJxV5mBtlDFB5VjYTaGZ2sf4R9PM7U9ZU+lLuaetPP/5Die3ToO1+u+MKtHs06qODB2zBnI/jBd4MPQm1VkY79Tb18gB+C62FdBFsZR6yeIo1YQiLJWMIiqVjQIu1YSCLNWFgijVjYIuhYYCKoWKAiiFgoopxYaKLUWOii2FgkophYp6F3r42W5A9s9OcgNvva8xQaysKXlFytoqdYmQH6tF3toSUo0INq9AAAAAElFTkSuQmCC\");\r\n                        }\r\n\r\n                        .DayPicker-NavButton--next {\r\n                            background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAwCAYAAAB5R9gVAAAABGdBTUEAALGPC/xhBQAAAXRJREFUWAnN119ugjAcwPHWzJ1gnmxzB/BBE0n24m4xfNkTaOL7wOtsl3AXMMb+Vjaa1BG00N8fSEibPpAP3xAKKs2yjzTPH9RAjhEo9WzPr/Vm8zgE0+gXATAxxuxtqeJ9t5tIwv5AtQAApsfT6TPdbp+kUBcgVwvO51KqVhMkXKsVJFXrOkigVhCIs1Y4iKlWZxB1rX4gwlpRIIpa8SDkWmggrFq4IIRaJKCYWnSgnrXIQV1r8YD+1Vrn+bReagysIFfLABRt31v8oBu1xEBttfRbltmfjgEcWh9snUS2kNdBK6WN1vrOWxObWsz+fjxevsxmB1GQDfINWiev83nhaoiB/CoOU438oPrhXS0WpQ9xc1ZQWxWHqUYe0I0qrKCQKjygDlXIQV2r0IF6ViEBxVTBBSFUQQNhVYkHIVeJAtkNsbQ7c1LtzP6FsObhb2rCKv7NBIGoq4SDmKoEgTirXAcJVGkFSVVpgoSrXICGUMUH/QBZNSUy5XWUhwAAAABJRU5ErkJggg==\");\r\n                        }\r\n\r\n                        .DayPicker-NavButton--interactionDisabled {\r\n                            display: none;\r\n                        }\r\n\r\n                        .DayPicker-Caption {\r\n                            display: table-caption;\r\n                            margin-bottom: 0.5em;\r\n                            padding: 0 0.5em;\r\n                            text-align: left;\r\n                            color: white;\r\n                        }\r\n\r\n                        .DayPicker-Caption > div {\r\n                            font-weight: 500;\r\n                            font-size: 1.15em;\r\n                        }\r\n\r\n                        .DayPicker-Weekdays {\r\n                            display: table-header-group;\r\n                            margin-top: 1em;\r\n                        }\r\n\r\n                        .DayPicker-WeekdaysRow {\r\n                            display: table-row;\r\n                        }\r\n\r\n                        .DayPicker-Weekday {\r\n                            display: table-cell;\r\n                            padding: 0.5em;\r\n                            color: #8b9898;\r\n                            text-align: center;\r\n                            font-size: 0.875em;\r\n                        }\r\n\r\n                        .DayPicker-Weekday abbr[title] {\r\n                            border-bottom: none;\r\n                            text-decoration: none;\r\n                        }\r\n\r\n                        .DayPicker-Body {\r\n                            display: table-row-group;\r\n                        }\r\n\r\n                        .DayPicker-Week {\r\n                            display: table-row;\r\n                        }\r\n\r\n                        .DayPicker-Day {\r\n                            display: table-cell;\r\n                            padding: 0.5em;\r\n                            border-radius: 50%;\r\n                            vertical-align: middle;\r\n                            text-align: center;\r\n                            cursor: pointer;\r\n                            color: gray;\r\n                        }\r\n\r\n                        .DayPicker-WeekNumber {\r\n                            display: table-cell;\r\n                            padding: 0.5em;\r\n                            min-width: 1em;\r\n                            border-right: 1px solid #eaecec;\r\n                            color: #8b9898;\r\n                            vertical-align: middle;\r\n                            text-align: right;\r\n                            font-size: 0.75em;\r\n                            cursor: pointer;\r\n                        }\r\n\r\n                        .DayPicker--interactionDisabled .DayPicker-Day {\r\n                            cursor: default;\r\n                        }\r\n\r\n                        .DayPicker-Footer {\r\n                            padding-top: 0.5em;\r\n                        }\r\n\r\n                        .DayPicker-TodayButton {\r\n                            border: none;\r\n                            background-color: transparent;\r\n                            background-image: none;\r\n                            box-shadow: none;\r\n                            color: #4a90e2;\r\n                            font-size: 0.875em;\r\n                            cursor: pointer;\r\n                        }\r\n\r\n                        .DayPicker-Day--today {\r\n                            color: white;\r\n                            font-weight: 700;\r\n                        }\r\n\r\n                        .DayPicker-Day--outside {\r\n                            color: #8b9898;\r\n                            cursor: default;\r\n                        }\r\n\r\n                        .DayPicker-Day--disabled {\r\n                            color: #dce0e0;\r\n                            cursor: default;\r\n                            /* background-color: #eff1f1; */\r\n                        }\r\n\r\n                        /* Example modifiers */\r\n\r\n                        .DayPicker-Day--sunday {\r\n                            background-color: #f7f8f8;\r\n                        }\r\n\r\n                        .DayPicker-Day--sunday:not(.DayPicker-Day--today) {\r\n                            color: #dce0e0;\r\n                        }\r\n\r\n                        .DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside) {\r\n                            position: relative;\r\n\r\n                            background-color: #4a90e2;\r\n                            color: #f0f8ff;\r\n                        }\r\n\r\n                        .DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside):hover {\r\n                            background-color: #51a0fa;\r\n                        }\r\n\r\n                        .DayPicker:not(.DayPicker--interactionDisabled)\r\n                            .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside):hover {\r\n                            background-color: #f0f8ff;\r\n                        }\r\n\r\n                        /* DayPickerInput */\r\n\r\n                        .DayPickerInput {\r\n                            display: inline-block;\r\n                        }\r\n\r\n                        .DayPickerInput-OverlayWrapper {\r\n                            position: relative;\r\n                        }\r\n\r\n                        .DayPickerInput-Overlay {\r\n                            position: absolute;\r\n                            left: 0;\r\n                            z-index: 1;\r\n\r\n                            background: white;\r\n                            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);\r\n                        }\r\n                    `}</style>\r\n                </Container>\r\n            );\r\n        } else {\r\n            return <p>loading</p>;\r\n        }\r\n    }\r\n}\r\n\r\nexport default index;\r\n"]},"metadata":{},"sourceType":"module"}